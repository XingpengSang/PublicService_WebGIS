body, html { margin: 0; height: 100%; overflow: hidden; font-family: 'Segoe UI', sans-serif; }

#map { width: 100%; height: 100%; z-index: 1; }

.header h3 { margin: 0; color: #333; font-size: 18px; }
.content { margin-top: 15px; }

/*#region --- 侧边栏样式 --- */
.sidebar {
    position: absolute; 
    top: 20px; 
    left: 20px; 
    width: 380px; 
    
    /* 保持原有的背景和圆角 */
    background: rgba(255, 255, 255, 0.92); 
    backdrop-filter: blur(8px); 
    -webkit-backdrop-filter: blur(8px);
    border-radius: 8px; 
    box-shadow: 0 4px 15px rgba(0,0,0,0.15); 
    z-index: 1000; 
    
    max-height: 90vh;        /* 限制最大高度 */
    height: auto;            /* 自动高度 */
    display: flex;           /* 启用 Flex 布局 */
    flex-direction: column;  /* 垂直排列 */
    overflow: hidden;        /* 隐藏容器整体的滚动条，交给子元素滚动 */
    padding: 15px;           /* 保持内边距 */
    padding-bottom: 0;       /* 底部内边距设为0，让Footer贴底 */
}

/* 侧边栏折叠状态 */
.sidebar.collapsed {
    /* 向左移动 100% 的宽度，加上左边距 20px，彻底隐藏主体 */
    transform: translateX(calc(-100% - 20px));
}

/* 折叠/展开按钮样式 */
.sidebar-toggle-btn {
    position: absolute;
    /* 定位在侧边栏的右侧外部 */
    left: 100%; 
    top: 20px;
    
    width: 32px;
    height: 40px;
    
    /* 样式与侧边栏保持一致 */
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(5px);
    border: 1px solid #e5e7eb;
    border-left: none; /* 去掉左边框，看起来像长在侧边栏上 */
    border-radius: 0 6px 6px 0; /* 右边圆角 */
    box-shadow: 4px 0 8px rgba(0,0,0,0.1);
    
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #666;
    font-size: 14px;
    z-index: 1001;
    
    transition: background 0.2s, color 0.2s;
}

.sidebar-toggle-btn:hover {
    background: #f3f4f6;
    color: #3b82f6;
}

/*#endregion */

/* 输入框样式 */
.form-control {
    width: 100%; padding: 8px; border-radius: 6px;
    border: 1px solid #ccc; margin-bottom: 10px;
}

/*#region 按钮样式 */
.btn-primary {
    width: 100%; padding: 10px; background: #3b82f6; color: white;
    border: none; border-radius: 6px; cursor: pointer; font-size: 14px;
    transition: background 0.2s;
}
.btn-primary:hover { background: #2563eb; }

.btn-secondary {
    width: 100%; 
    padding: 10px; 
    background: #10b981; /* 翡翠绿，区别于蓝色的主按钮 */
    color: white;
    border: none; 
    border-radius: 6px; 
    cursor: pointer; 
    font-size: 14px;
    transition: background 0.2s;
    margin-bottom: 10px; /* 和下面的按钮拉开距离 */
}

.btn-secondary:hover { 
    background: #059669; 
}

/* 给激活状态（已加载）加个样式 */
.btn-secondary.active {
    background: #6b7280; /* 变成灰色，表示点击可关闭 */
}

.btn-xs { 
    padding: 4px 8px; 
    font-size: 13px; 
    border-radius: 4px; 
    border: none; 
    cursor: pointer; 
    display: flex;
    align-items: center;
    justify-content: center;
    height: 22px;
}
/*#endregion */

/*#region 复选框样式 */
.form-check {
    margin-bottom: 8px;
    display: flex;
    align-items: center;
}
.road-checkbox {
    margin-right: 8px;
    width: 16px;
    height: 16px;
    
    cursor: pointer;
}
/*#endregion */

/*#region 列表样式优化 (增加行号、ID列) */
.poi-list {
    max-height: 350px; /* 稍微增高一点可视区域 */
    overflow-y: auto;
    border: 1px solid #e5e7eb;
    background: rgba(255, 255, 255, 0.6); /* 列表内部稍微透明一点 */
    font-size: 12px;
    border-radius: 4px;
}

.poi-header {
    display: grid;
    /* # | ID | 类型 | 名称 | 删 */
    grid-template-columns: 35px 75px 90px 1fr 35px; 
    background: #f3f4f6;
    padding: 8px 5px;
    font-weight: bold;
    border-bottom: 1px solid #ddd;
    color: #374151;
    position: sticky;
    top: 0;
    z-index: 10;
}

.poi-row {
    display: grid;
    /* 必须与 header 保持一致 */
    grid-template-columns: 35px 75px 90px 1fr 35px;
    padding: 6px 5px;
    border-bottom: 1px solid #f9fafb;
    align-items: center;
    cursor: pointer;
    user-select: none; /* 防止按Shift点击时选中文本 */
}

.poi-row:hover { background-color: #eff6ff; }
.poi-row.deleted { color: #ccc; text-decoration: line-through; }

/* 单元格通用样式：文本截断,文字超长自动省略号 */
.poi-cell { 
    white-space: nowrap; 
    overflow: hidden; 
    text-overflow: ellipsis; 
    padding-right: 5px;
    line-height: 24px;
}
/*#endregion */

/*#region POI 列表选中状态 */
/* 选中行高亮颜色 (淡黄色) */
.poi-row.selected {
    background-color: #fef08a !important; 
    border-left: 3px solid #f59e0b;
}

/* 鼠标悬停微调 */
.poi-row:hover {
    background-color: #f3f4f6;
}
.poi-row.selected:hover {
    background-color: #fde047 !important;
}
/*#endregion */

/*#region 模态框 (Modal) 样式 */
.modal-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.5); z-index: 9999;
    display: none; justify-content: center; align-items: center;
}
.modal-box {
    background: white; padding: 20px; border-radius: 8px; width: 400px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
}
.modal-header { font-weight: bold; font-size: 16px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
.modal-body { margin-bottom: 15px; }
.modal-footer { text-align: right; }
.missing-item {
    background: #fff7ed; border: 1px solid #fdba74; padding: 10px; margin-bottom: 10px; border-radius: 4px;
}
.badge { display: inline-block; padding: 2px 6px; background: #e5e7eb; border-radius: 4px; font-size: 11px; margin-right: 5px; }
/*#endregion */

/*#region 居民点分析结果的 Tooltip 样式 */
.place-tooltip {
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid #10b981;
    border-radius: 6px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    font-size: 12px;
    padding: 0; /* 让内部 div 控制 padding */
}

/* 修正 Leaflet 默认的小三角箭头颜色，使其匹配绿色边框 */
.leaflet-tooltip-left.place-tooltip::before {
    border-left-color: #10b981;
}
.leaflet-tooltip-right.place-tooltip::before {
    border-right-color: #10b981;
}
.leaflet-tooltip-top.place-tooltip::before {
    border-top-color: #10b981;
}
.leaflet-tooltip-bottom.place-tooltip::before {
    border-bottom-color: #10b981;
}
/*#endregion */

/* 左下角经纬度显示 */
.mouse-coords-box {
    position: absolute;
    bottom: 0;
    left: 0;
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(4px);
    padding: 2px 10px;
    font-size: 12px;
    font-family: monospace; /* 等宽字体数字不跳动 */
    color: #333;
    z-index: 2000; /* 保证在地图之上 */
    border-top-right-radius: 5px;
    pointer-events: none; /* 让鼠标穿透它，不影响地图操作 */
}

/*#region 右上角工具栏 */
.edit-toolbar {
    position: absolute;
    top: 20px;
    right: 20px;
    z-index: 2000;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.tool-btn {
    width: 40px;
    height: 40px;
    background: white;
    border: none;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    cursor: pointer;
    font-size: 18px;
    color: #555;
    transition: all 0.2s;
}

.tool-btn:hover { background: #f3f4f6; color: #3b82f6; }
.tool-btn.active { background: #3b82f6; color: white; }

.mode-tip {
    background: rgba(0,0,0,0.7);
    color: white;
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 12px;
    text-align: center;
    margin-top: 5px;
}

/* 通用辅助类 */
.w-100 { width: 100%; }
.mb-2 { margin-bottom: 8px; }
.mt-1 { margin-top: 4px; }

/* 表单样式 */
.form-row { margin-bottom: 10px; }
.form-row label { display: block; font-size: 12px; color: #666; margin-bottom: 2px; }
.form-row input { width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;}
.form-row input:disabled { background: #f9fafb; color: #999; }
/*#endregion */

/*#region --- 侧边栏底部数据控制区 --- */

/* 1. 底部容器：固定在侧边栏最下方，带有顶部边框 */
.sidebar-footer {
    flex-shrink: 0;          /* 禁止被压缩，确保始终完整显示 */
    margin-top: 0;           /* 不需要 auto 了，因为中间撑开了 */
    padding-top: 15px;
    padding-bottom: 15px;    /* 底部留出空间 */
    border-top: 1px solid #e5e7eb;
    display: flex;
    flex-direction: column;
    gap: 10px;
    background: transparent; /* 或者设置背景色遮挡滚动内容 */
    z-index: 2;
}

/* 2. 数据源状态标签 */
.data-status {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    font-size: 12px;
    color: #6b7280;
    background: #f3f4f6;
    padding: 6px;
    border-radius: 6px;
}

.data-status i {
    color: #10b981; /* 绿色的小图标表示状态正常 */
}

/* 3. 美化后的导入按钮 */
.btn-import-lg {
    width: 100%;
    padding: 10px 15px;
    background: linear-gradient(135deg, #4f46e5 0%, #6366f1 100%); /* 渐变蓝紫色 */
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.2);
}

.btn-import-lg:hover {
    background: linear-gradient(135deg, #4338ca 0%, #4f46e5 100%);
    transform: translateY(-1px); /* 悬停微微上浮 */
    box-shadow: 0 6px 10px -1px rgba(79, 70, 229, 0.3);
}

.btn-import-lg:active {
    transform: translateY(0);
}
/*#endregion */

/*#region --- 列表行定位高亮 --- */
@keyframes flash-highlight {
    0% { background-color: #fde047; } /* 亮黄色 */
    50% { background-color: #fef9c3; }
    100% { background-color: transparent; }
}

.poi-row.flash-active {
    animation: flash-highlight 4s ease-out;
}

/* 列表下方的交互提示样式 */
.interaction-tip {
    font-size: 11px;
    color: #6b7280; /* 灰色文字 */
    background-color: #f3f4f6; /* 浅灰背景 */
    padding: 8px;
    border-radius: 6px;
    margin-top: 8px;
    border: 1px dashed #d1d5db;
    line-height: 1.5;
}

.interaction-tip i {
    color: #f59e0b; /* 灯泡图标用黄色 */
    margin-right: 4px;
}
/*#endregion */

/*#region --- 选项卡内容区滚动条优化 --- */
.tab-content {
    display: none; /* 默认隐藏 (由JS控制显示) */
    
    /* 当显示时，flex: 1 让它占据 header 和 footer 剩下的所有空间 */
    /* 注意：需要在JS切换Tab显示时，确保 active 的 tab-content 才有 flex: 1 */
    /* 这里我们用通用样式，配合 .active */
    overflow-y: auto;        /* 内容超长时，只在这一块显示滚动条 */
    padding-right: 5px;      /* 防止滚动条遮挡内容 */
    padding-bottom: 10px;    /* 底部留点空隙 */
    margin-bottom: 0;        /* 去掉多余边距 */
    min-height: 0;           /* Firefox Flex 滚动修复 */
}

/* 确保激活的 Tab 内容占满剩余空间 */
.tab-content.active {
    display: block;
    flex: 1;                 /* 关键：撑开剩余高度 */
}
/*#endregion */

/*#region --- 滚动条样式 --- */
/* 滚动条整体 */
.tab-content::-webkit-scrollbar {
    width: 6px;
}

/* 滚动条轨道 */
.tab-content::-webkit-scrollbar-track {
    background: transparent; 
}

/* 滚动条滑块 */
.tab-content::-webkit-scrollbar-thumb {
    background-color: #d1d5db; 
    border-radius: 3px;
}

/* 滑块悬停 */
.tab-content::-webkit-scrollbar-thumb:hover {
    background-color: #9ca3af; 
}
/*#endregion */
